<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Liga – Round Robin</title>
<style>
  body {
    margin: 0;
    font-family: "Segoe UI", sans-serif;
    background: #111;
    color: #fff;
    background-image: url("logo.jpg");
    background-size: cover;
    background-position: center;
  }
  .overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.7);
    z-index: 0;
  }
  .container {
    position: relative;
    z-index: 1;
    text-align: center;
    padding: 20px;
  }
  img.logo {
    width: 120px;
    border-radius: 12px;
    box-shadow: 0 0 15px rgba(255,255,255,0.2);
  }
  h1 {
    margin-top: 10px;
    color: #00bfff;
  }
  table {
    width: 90%;
    margin: 20px auto;
    border-collapse: collapse;
    border-radius: 12px;
    overflow: hidden;
    background: rgba(30,30,30,0.9);
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
  }
  th, td {
    padding: 8px 10px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  th {
    background: rgba(0,0,0,0.6);
    color: #00bfff;
  }
  input {
    width: 40px;
    text-align: center;
    border: none;
    border-radius: 4px;
    background: #222;
    color: #fff;
    padding: 4px;
  }
  button {
    margin: 10px;
    padding: 10px 20px;
    background: #00bfff;
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.2s;
  }
  button:hover {
    background: #0099cc;
  }
</style>
</head>
<body>
<div class="overlay"></div>
<div class="container">
  <img src="logo.jpg" class="logo" alt="Logo">
  <h1>Mini Liga – Round Robin</h1>
  <h2>Raspored i unos rezultata</h2>
  <table id="matchesTable"></table>
  <button onclick="updateTable()">Ažuriraj tabelu</button>
  <button onclick="resetResults()">Resetuj rezultate</button>

  <h2>Rang tabela</h2>
  <table id="standingsTable"></table>
</div>

<script>
const teams = ["Vladimir","Mirko","Uroš","Jovan","Lazar","Bojan","Miljan","Nikola"];
let matches = [];

// Generate all matches (home and away)
function generateMatches() {
  matches = [];
  for (let i = 0; i < teams.length; i++) {
    for (let j = 0; j < teams.length; j++) {
      if (i !== j) matches.push({home: teams[i], away: teams[j], homeGoals: "", awayGoals: ""});
    }
  }
}

// Load saved results
function loadResults() {
  const saved = localStorage.getItem("ligaRezultati");
  if (saved) matches = JSON.parse(saved);
  else generateMatches();
}

// Save results
function saveResults() {
  localStorage.setItem("ligaRezultati", JSON.stringify(matches));
}

// Reset results
function resetResults() {
  if (confirm("Da li želiš da obrišeš sve rezultate?")) {
    localStorage.removeItem("ligaRezultati");
    generateMatches();
    renderMatches();
    updateTable();
  }
}

// Render match table
function renderMatches() {
  const table = document.getElementById("matchesTable");
  table.innerHTML = "<tr><th>Domaćin</th><th>Golovi</th><th>Gost</th><th>Golovi</th></tr>";
  matches.forEach((m, i) => {
    table.innerHTML += `
      <tr>
        <td>${m.home}</td>
        <td><input type="number" min="0" value="${m.homeGoals}" onchange="setScore(${i}, 'home', this.value)"></td>
        <td>${m.away}</td>
        <td><input type="number" min="0" value="${m.awayGoals}" onchange="setScore(${i}, 'away', this.value)"></td>
      </tr>`;
  });
}

// Update score in array
function setScore(index, side, value) {
  matches[index][side + "Goals"] = value;
  saveResults();
}

// Calculate standings
function updateTable() {
  const standings = teams.map(t => ({
    team: t, played: 0, win: 0, draw: 0, loss: 0, gf: 0, ga: 0, points: 0
  }));

  matches.forEach(m => {
    if (m.homeGoals !== "" && m.awayGoals !== "") {
      const home = standings.find(t => t.team === m.home);
      const away = standings.find(t => t.team === m.away);
      const hg = parseInt(m.homeGoals), ag = parseInt(m.awayGoals);
      home.played++; away.played++;
      home.gf += hg; home.ga += ag;
      away.gf += ag; away.ga += hg;

      if (hg > ag) { home.win++; away.loss++; home.points += 3; }
      else if (hg < ag) { away.win++; home.loss++; away.points += 3; }
      else { home.draw++; away.draw++; home.points++; away.points++; }
    }
  });

  standings.sort((a,b) => 
    b.points - a.points ||
    (b.gf - b.ga) - (a.gf - a.ga) ||
    b.gf - a.gf
  );

  const table = document.getElementById("standingsTable");
  table.innerHTML = `
    <tr>
      <th>Poz</th><th>Tim</th><th>Utakmice</th><th>Pobede</th>
      <th>Nerešeno</th><th>Porazi</th><th>Dati</th><th>Primljeni</th>
      <th>Gol razlika</th><th>Bodovi</th>
    </tr>
  `;
  standings.forEach((t,i) => {
    table.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td>${t.team}</td>
        <td>${t.played}</td>
        <td>${t.win}</td>
        <td>${t.draw}</td>
        <td>${t.loss}</td>
        <td>${t.gf}</td>
        <td>${t.ga}</td>
        <td>${t.gf - t.ga}</td>
        <td>${t.points}</td>
      </tr>`;
  });
  saveResults();
}

// Initial load
loadResults();
renderMatches();
updateTable();
</script>
</body>
</html>
